---
id: 'afc8f43d-f33a-4e69-9a77-8b6f46da32e0'
alias: 'Back Door Events'
use_blueprint:
  path: 'yale_assure_events.yaml'
  input:
    lock: 'Back Door Lock'
    keypad_unlock:
      - variables:
          users:
            - 'josh'
            - 'lily'
          friendly_name: >-
            {% if user == 1 %}
              master code
            {% else %}
              {{ state_attr('person.' ~ users[user - 2], 'friendly_name') }}
            {% endif %}
      - service: 'logbook.log'
        data:
          message: 'was unlocked by {{ friendly_name }}'
          <<: &common_data
            name: 'Back Door'
            entity_id: 'lock.back_door'
            domain: 'lock'
    manual_lock:
      service: 'logbook.log'
      data:
        message: 'was locked manually'
        <<: *common_data
    manual_unlock:
      service: 'logbook.log'
      data:
        message: 'was unlocked manually'
        <<: *common_data
    touch_lock:
      service: 'logbook.log'
      data:
        message: 'was locked by touchscreen'
        <<: *common_data
    pin_code_added:
      service: 'logbook.log'
      data:
        message: 'was setup with a PIN code for user {{ user }}'
        <<: *common_data
